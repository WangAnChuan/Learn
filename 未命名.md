第三章 方法论

3.1 整体框架

针对水面漂浮物检测中存在的背景动态干扰（如光照反光、连续波纹）以及透明目标视觉特征模糊的问题，本文提出了一种物理感知与指标驱动的目标检测框架（Physically-Informed and Metric-Driven Framework）。如图 3 所示，该框架以 YOLO11 为基准架构，并在两个关键维度上进行了创新性重构：

1. 物理感知层面（Data-Centric）：该框架不再采用传统的单模态输入，转而采用异构多模态联合训练策略。除了传统的光强模态（RGB与Mono），本文进一步引入了包含线偏振度（DoLP）、偏振角（AoP）、Pauli分解及差分（DIF）在内的全偏振物理特征。这种高维度的物理信息输入，不仅补充了物体表面的几何与材质纹理信息，更促使模型通过多流架构学习跨模态的光照不变性特征，从物理源头增强了模型在强反射或低对比度场景下的鲁棒性。
    
2. 指标驱动层面（Model-Centric）：不同于盲目的网络堆叠，本研究提出了一种指标驱动的架构优化策略。研究利用层级特征聚类评估（FCE）作为诊断探针，量化特征空间的流形分布。实验结果发现特征融合阶段（特别是 Layer 19）存在显著的类内方差漂移（High Intra-class Variance），表明模型在此处未能有效捕捉全局上下文以维持语义一致性。以此为依据，本文将状态空间模型（Mamba）嵌入该瓶颈层级，利用其线性复杂度的全局感受野压缩同类特征分布，提升了特征的语义紧致度（Semantic Compactness）与判别力，实现了从经验试错向诊断-修复范式的跨越。

3.2 物理感知的异构数据策略

传统的水面目标检测算法往往仅依赖 RGB 图像，这使得模型极易受镜面反射（Specular Reflection）与视觉伪装（Visual Camouflage）的干扰。为了克服这一物理瓶颈，本文并未简单地增加网络输入的通道数，而是提出了一种物理域随机化（Physical Domain Randomization）的数据增强策略。

具体而言，本研究将原始传感器数据解译为 $K=6$ 种异构的物理视图，并将其视为独立的训练样本：

1. 强度模态（Intensity Modalities）：包括可见光（RGB）与单色（Mono）图像。这些模态提供了基础的纹理与几何轮廓信息。
    
2. 偏振模态（Polarization Modalities）：包括线偏振度（DoLP）、偏振角（AoP）以及 Pauli 分解分量。由于水面反射光通常具有高偏振特性，而漫反射的目标物体偏振度较低，这些模态能够为目标与背景的分离提供正交的物理线索。
    

形式化地，构建异构数据集 $D = \{ (I_{RGB}, y), (I_{DoLP}, y), \dots \}$。通过在训练流中混合这些物理属性不同的视图，本文旨在促使骨干网络忽略高频的模态特定噪声（如 RGB 中的反光伪影），转而聚焦于学习模态不变的几何特征。这一策略与后续引入的 Mamba 模块形成互补：异构数据提供了丰富的物理变化，而 Mamba 强大的全局上下文能力则能从中提取出稳健的结构化特征。

3.3 指标驱动诊断：层级特征聚类评估

为了降低深度神经网络设计中的不可解释性，本研究提出了层级特征聚类评估（Hierarchical Feature Clustering Evaluation, FCE）框架，旨在量化探测特征流形空间中前景（漂浮物）与背景（水面）的分布质量，从而为架构改良提供客观依据。

3.3.1 FCE 评估机制

为了量化特征在深层网络中的演化行为，本文定义了 FCE 机制。令 $F_l \in \mathbb{R}^{H \times W \times C}$ 表示主干网络第 $l$ 层输出的特征张量。

本研究首先通过 RoIAlign 操作，基于真值标注（Ground Truth, $B_{gt}$）与背景采样策略，分别提取前景特征集合 $V_{fg}$ 与背景特征集合 $V_{bg}$。为了缓解高维特征空间的稀疏性并提取主成分流形，本文采用主成分分析（PCA）将特征向量投影至低维子空间 $\mathbb{R}^d$。在此基础上，定义 Fisher 判别力分数（Fisher Discriminant Score, $S_{fce}$）作为衡量特征可分性的核心指标：

$$S_{fce}^{(l)} = \frac{\|\boldsymbol{\mu}_{fg} - \boldsymbol{\mu}_{bg}\|_2^2}{\text{Tr}(\mathbf{\Sigma}_{fg}) + \text{Tr}(\mathbf{\Sigma}_{bg}) + \epsilon}$$

其中，$\boldsymbol{\mu}_{fg}$ 与 $\boldsymbol{\mu}_{bg}$ 分别表示前景与背景特征簇在低维流形中的质心；$\mathbf{\Sigma}_{fg}$ 与 $\mathbf{\Sigma}_{bg}$ 为对应的协方差矩阵，$\text{Tr}(\cdot)$ 表示矩阵的迹（即类内方差之和），用于度量特征分布的紧致度（Compactness）；$\epsilon$ 为数值稳定项。该指标在物理意义上等价于信噪比（SNR）：分子量化了信号（类间差异）的强度，分母量化了噪声（类内发散）的干扰。$S_{fce}$ 值越高，表明该层特征具备越强的语义判别力。
3.3.2 基于 FCE 的特征退化诊断

利用 FCE 探针，本研究对基准模型（YOLO11）的关键层级（索引：13, 16, 19, 22）进行了逐层扫描，揭示了其在复杂水面环境下的特征表达瓶颈。

1. 总体趋势分析：
    
    如图 1(a) 所示，FCE 评分随网络深度呈现显著的非单调波动。尽管深层输出（Layer 22）的评分有所回升，但中间层级（特别是 Layer 13 与 Layer 19）出现了剧烈的语义塌陷（Semantic Collapse）。这表明，虽然检测头（Head）能够通过后处理恢复部分识别能力，但在主干网络的深层特征抽象阶段，模型已经丢失了大量关键判别信息，形成了特征流形中的断裂带。
    
2. 指标分解与病理分析：
    
    通过解耦 FCE 指标的分子与分母，本研究定位了具体的病理特征：
    

- 类内发散：如图 1(b) 所示，Layer 19 表现出异常高的类内离散度（Intra-class Distance）。这意味着同一前景目标的特征在流形空间中极度发散。物理层面的解释是：深层卷积虽然感受野增大，但仍受限于局部窗口，对水面反光、倒影等局部形变过于敏感，导致模型未能将破碎的物体局部特征聚类为一个紧凑的语义整体。
    
- 背景混叠：如图 1(c) 所示，Layer 13 的类间分离度（Inter-class Separation）处于最低点。这揭示了模型在此层级无法有效抑制与前景纹理高度相似的水波纹噪声（Water ripples），导致前景与背景在特征空间中发生了严重的语义纠缠（Semantic Entanglement），难以划定清晰的决策边界。
    

3. 特征流形可视化：
    
    图 1(d) 的二维散点图直观验证了上述诊断：基准模型的 Layer 19（红色数据点）明显偏离了高分离度、低类内方差的理想区域，向着高发散、低区分的区域漂移。此外，图 1(e) 显示主成分分析（PCA）的前 $d$ 个主成分累积解释方差均超过 90%，确证了上述流形投影能够真实反映原始高维特征的拓扑结构。
    

诊断结论：FCE 诊断明确指出，Layer 13 至 Layer 19 是特征提取链路中的语义瓶颈。这种局部的特征退化本质上归因于卷积神经网络缺乏长距离依赖（Long-range Dependency）建模能力，无法利用水面的全局上下文一致性来校正局部的反光噪声或聚合发散的物体特征。这一量化结论为在该层级引入具有全局感受野的状态空间模型（Mamba）提供了理论与数据支撑。

3.4 C3k2-Mamba：上下文感知的骨干重构

为了解决 FCE 诊断出的深层特征语义塌陷问题，需要一种能够突破卷积局部感受野限制的机制。虽然 Transformer 能够建立全局依赖，但其二次方计算复杂度难以满足水面无人设备的实时性要求。因此，本研究引入了选择性状态空间模型（Selective State Space Models, Mamba）。

3.4.1 选择性状态空间模型原理

不同于卷积的滑动窗口机制，Mamba 将图像特征展平为一维序列，并利用线性时不变系统（LTI）进行长距离上下文扫描。其核心离散化状态方程定义如下：

$$h_t = \bar{\mathbf{A}} h_{t-1} + \bar{\mathbf{B}} x_t$$

$$y_t = \mathbf{C} h_t$$

其中，$x_t$ 为输入特征序列，$h_t$ 为隐状态，$y_t$ 为输出。通过这种递归形式，Mamba 能够在线性复杂度下将全图的波浪纹理和光照分布编码进隐状态中。对于目标检测而言，模型在判断局部像素属性时能够参考全图的背景一致性信息，从而有效抑制与全局背景相似的局部反光噪声。

3.4.2 针对性的深层骨干重构

基于 FCE 的诊断结论，本文实施了指标驱动的局部手术策略。为了平衡计算效率与物理感知能力，本研究保留了浅层（P1-P3）的卷积结构，以维持对高频物理特征的提取优势。针对出现严重语义混叠的深层阶段（P4, P5），本文设计并植入了 C3k2-Mamba 模块，以替代原有的 Bottleneck 结构。

C3k2-Mamba 模块设计：

如图 3 所示，该模块将状态空间模型（SSM）嵌入 CSP 流形架构中。本研究采用了一种双流密集聚合（Dual-stream Dense Aggregation）机制：

1. 特征分流：输入张量 $X$ 首先经过 $1\times1$ 卷积降维，并在通道维度被分割为守恒流 $X_{id}$ 和计算流 $X_{comp}$，以确保梯度的无损传播。
    
2. 级联状态空间建模：计算流进入堆叠的 Mamba Blocks 序列。为了提高深层网络的特征复用率，本研究构建了密集连接链路。令 $M_i$ 表示第 $i$ 个 Mamba Block，输出序列 $Y_i$ 递归定义为：
    
    $$Y_0 = X_{comp}, \quad Y_i = M_i(Y_{i-1}), \quad i=1, \dots, N$$
    
3. 全维上下文重组：最终的输出由所有中间状态与初始分流聚合而成。这种设计促使模型在每一层将 Mamba 提取的全局上下文与局部特征进行对齐：
    
    $$Y_{out} = \text{Conv}_{1\times1}\left( \text{Concat}[X_{id}, Y_0, Y_1, \dots, Y_N] \right)$$
    

通过密集拼接策略，C3k2-Mamba 模块利用 Mamba 的全局感受野修复了语义断裂，并在深层网络中建立了多尺度的语义索引，使模型能够利用全局上下文将前景目标从复杂的背景流形中精确剥离，直接解决了 FCE 诊断出的类内发散与背景混叠问题。