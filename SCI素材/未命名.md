### **第三章 方法论 (Methodology)**

#### **3.1 整体框架 (Overall Framework)**

**针对水面漂浮物检测中存在的背景动态干扰（如光照反光、连续波纹）以及透明目标视觉特征模糊的问题，本文提出了一种物理感知与指标驱动的目标检测框架（Physically-Informed and Metric-Driven Framework）。如图 Fig. 3 所示，该框架以 YOLO11 为基准架构，但在两个关键维度上进行了创新性重构：**

1. **物理感知层面（Data-Centric）：我们摒弃了传统的单模态输入，转而采用异构多模态联合训练策略。除了传统的光强模态（RGB与Mono），我们进一步引入了包含线偏振度（DoLP）、偏振角（POL）、Pauli分解及差分（DIF）在内的全偏振物理特征。这种高维度的物理信息输入，不仅补充了物体表面的几何与材质纹理信息，更促使模型通过多流架构学习跨模态的光照不变性特征，从物理源头显著增强了模型在强反射或低对比度场景下的鲁棒性。**
    
2. **指标驱动层面（Model-Centric）：** 不同于盲目的网络堆叠，本研究提出了一种**指标驱动的架构优化策略。我们利用层级特征聚类评估（FCE）作为诊断探针，量化了特征空间的流形分布。揭示了特征融合阶段（特别是 Layer 19）存在显著的**类内方差漂移（High Intra-class Variance）**，表明模型在此处未能有效捕捉全局上下文以维持语义一致性。以此为依据，我们将**状态空间模型（Mamba）**嵌入该瓶颈层级，利用其线性复杂度的**全局感受野“压缩”同类特征分布，显著提升了特征的**语义紧致度（Semantic Compactness）**与判别力，实现了从“经验试错”向**“诊断-修复”**范式的跨越。
    

#### **3.2 物理感知的异构数据策略 (Physically-Informed Heterogeneous Data Strategy)**

**传统的水面目标检测算法往往仅依赖 RGB 图像，这使得模型极易受镜面反射（Specular Reflection）与视觉伪装（Visual Camouflage）的干扰。为了克服这一物理瓶颈，我们并未简单地增加网络输入的通道数，而是提出了一种“物理域随机化（Physical Domain Randomization）”的数据增强策略。****

**具体而言，我们将原始传感器数据解译为 $K=6$ 种异构的物理视图，并将其视为独立的训练样本：**
- **强度模态（Intensity Modalities）： 包括可见光（RGB）与近红外/单色（Mono）。这些模态提供了基础的纹理与几何轮廓信息。**
- 偏振模态（Polarization Modalities）： 包括线偏振度（DoLP）、偏振角（AoP）、以及 Pauli 分解分量。由于水面反射光通常具有高偏振特性，而漫反射的目标物体偏振度较低，这些模态能够为“前景-背景”分离提供正交的物理线索。
**形式化地，构建异构数据集 $\mathcal{D} = \{ (I_{RGB}, y), (I_{DoLP}, y), \dots \}$。通过在训练流中混合这些物理属性迥异的视图，我们迫使骨干网络忽略高频的模态特定噪声（如 RGB 中的反光伪影），转而聚焦于学习模态不变的几何特征。这一策略与后续引入的 Mamba 模块形成了完美的互补：异构数据提供了丰富的物理变化，而 Mamba 强大的全局上下文能力则能从中提取出稳健的结构化特征。
#### 3.3 指标驱动诊断：层级特征聚类评估 (Metric-Driven Diagnosis: FCE)**

**为了克服深度神经网络设计中的不可解释性，我们提出了 FCE 框架，旨在量化探测特征流形空间中前景（漂浮物）与背景（水面）的分布质量，从而为架构改良提供客观依据。**

**3.3.1 评估机制**

**令 $\mathcal{F}_l \in \mathbb{R}^{H \times W \times C}$ 表示第 $l$ 层输出的特征图。基于真实标签（Ground Truth），我们分别采样前景特征向量集合 $V_{fg}$ 与背景特征向量集合 $V_{bg}$。为了消除高维空间的稀疏性并直观可视化，我们采用主成分分析（PCA）将特征向量投影至低维流形空间，并定义类间分离度分数（Separation Score, $S_{sep}$）：**

**$$S_{sep}^{(l)} = \frac{\|\mu_{fg} - \mu_{bg}\|_2}{\sqrt{\sigma_{fg}^2 + \sigma_{bg}^2} + \epsilon}$$**

**其中，$\mu$ 和 $\sigma^2$ 分别代表特征簇的质心与方差，$\epsilon$ 为防止分母为零的平滑项。$S_{sep}$ 值越高，意味着特征空间中的“前景-背景”边界越清晰。**

**3.3.2 基于 FCE 的特征退化量化诊断**

**为了探究基准模型（YOLO11）在水面复杂环境下的特征表达瓶颈，我们利用 FCE 框架对网络关键层级（索引为 13, 16, 19, 22）的特征空间进行了逐层扫描。**

- **总体趋势分析（对应图 Fig. 1a）： 如图 Fig. 1(a) 所示，FCE 综合评分在不同网络深度呈现出显著波动。相比于深层输出（Layer 22），中间层级（Layer 13 和 19）的评分出现了剧烈的“塌陷（Collapse）”。这表明，虽然网络最终能够通过 Head 部分恢复一定的识别能力，但在 Backbone 的深层特征提取阶段，模型已经丢失了大量关键的判别信息。****
    
- **指标分解与病理分析（对应图 Fig. 1b, 1c）：**
    
    - **类内紧凑度（图 b）： Layer 19 表现出了异常高的类内距离，意味着前景目标的特征分布极度发散，模型未能将其聚类为一个紧凑的语义整体，这通常归因于深层卷积对目标局部形变的不敏感。**
        
    - **前景-背景分离度（图 c）： Layer 13 和 Layer 19 的背景分离度显著偏低。这揭示了一个关键问题：在这些层级，模型无法有效抑制与前景纹理相似的水波纹噪声，导致前景与背景在特征空间中发生了严重的“语义混叠（Semantic Entanglement）”。****
        
- **特征空间可视化（对应图 Fig. 1d, 1e）： Fig. 1(d) 的二维散点图直观展示了这种退化：基准模型的 Layer 13 和 19（红色圆点）明显向右下方漂移，远离了理想的高分离度区域。此外，Fig. 1(e) 显示所有层级的 PCA 累积解释方差均超过 0.90，证明了上述流形投影的有效性。**
    

**诊断结论： FCE 诊断明确指出 Layer 13 和 Layer 19（对应 Backbone 的 P4/P5 阶段）是特征提取链路中的“薄弱环节”。这种局部的特征混叠现象，本质上是由于卷积核缺乏长距离依赖建模能力，无法利用水面的全局一致性来剔除局部反光噪声。这为后续引入全局感受野模块提供了直接的指标依据。**

#### **3.4 C3k2-Mamba：上下文感知的骨干重构 (C3k2-Mamba: Context-Aware Backbone Reconfiguration)**

**为了解决 FCE 诊断出的深层特征语义塌陷问题，我们需要一种能够突破卷积局部感受野限制的机制。虽然 Transformer 能够建立全局依赖，但其二次方计算复杂度（$O(N^2)$）难以满足水面无人设备的实时性要求。因此，我们引入了选择性状态空间模型（Selective State Space Models, Mamba）。**

**3.4.1 选择性状态空间模型原理**

**不同于卷积的滑动窗口机制，Mamba 将图像特征展平为一维序列，并利用线性时不变系统（LTI）进行长距离上下文扫描。其核心离散化状态方程定义如下：**

**\begin{align}**

**h_t &= \bar{\mathbf{A}} h_{t-1} + \bar{\mathbf{B}} x_t \****

**y_t &= \mathbf{C} h_t**

**\end{align}**

**其中，$x_t$ 为输入特征序列，$h_t$ 为隐状态，$y_t$ 为输出。通过这种递归形式，Mamba 能够在 $O(N)$ 的线性复杂度下，将整个水面的波浪纹理和光照分布编码进隐状态 $h_t$ 中。对于单类目标检测而言，这意味着模型在判断局部像素是否为“瓶子”时，不再仅仅依赖周围的几个像素，而是参考了全图的背景一致性信息，从而有效抑制与全局背景相似的局部反光噪声。**

**3.4.2 针对性的深层骨干重构**

**基于第 3.3 节的 FCE 诊断结论，我们采取了“指标驱动的局部手术（Metric-Driven Local Surgery）”策略。具体而言，我们保持了 YOLO11 骨干网络中浅层（P1-P3）的 C3k2 卷积模块不变，以保留其对边缘、角点等高频物理特征的高效提取能力。而在出现特征混叠的深层阶段（P4 和 P5），我们将原有的 Bottleneck 替换为 C3k2-Mamba 模块。**

**如图 Fig. 3 (Micro View) 所示，在该模块中，输入的深层语义特征首先经过 $1\times1$ 卷积降维，随后被分割为两条路径。主路径进入堆叠的 Mamba Block 进行全局上下文聚合。为了最大化特征复用，我们采用了密集拼接（Dense Concatenation）**策略：**

**$$Y_{out} = \text{Conv}_{1\times1}\left( \text{Concat}[Y_{shortcut}, Y_{main}, Y_{mamba}^{(1)}, \dots, Y_{mamba}^{(N)}] \right)$$**

**这种设计确保了深层网络能够“看清”水面全貌，利用全局上下文将孤立的前景目标从复杂的动态背景流形中剥离出来，直接修复了 FCE 揭示的语义混叠缺陷。**

### **第四章 实验与结果分析 (Experiments and Analysis)**

#### **4.1 数据集与实验设置 (Datasets and Implementation Details)**

**4.1.1 异构物理数据集构建**

**为了验证物理感知策略的有效性，我们选用公开的 [Dataset Name] 数据集 [Ref] 作为实验基准。该数据集包含 XX 对配准的可见光与偏振图像。依据 3.2 节所述的物理域随机化策略，我们将原始 RAW 数据解译为 $K=6$ 种异构物理视图（RGB, Mono, DoLP, AoP, $S_0$, Pauli-RGB），并将它们标准化为统一的 3 通道图像格式。**

- **训练集（物理域随机化）： 包含 XX 张图像。在训练过程中，我们采用异构模态联合训练（Heterogeneous Modality Joint Training）**策略，即以 $p=0.5$ 的概率随机切换输入的物理模态。这种策略迫使骨干网络忽略模态特定的高频噪声（如 RGB 中的反光伪影），转而学习模态不变的几何特征（Modality-Invariant Geometric Features）。**
    
- **测试集（分层评估）： 包含 XX 张图像。为了评估模型在极限条件下的鲁棒性，我们将测试集进一步细分为“强反光（Specular）”、“弱光照（Low-light）”和“常规（Normal）”三个子集。**
    

**4.1.2 实施细节**

**所有实验均在 Ubuntu 20.04 系统下进行，硬件环境为单张 NVIDIA RTX 3090 GPU。**

- **基准模型： 选用 YOLO11n 作为 Baseline，以验证轻量化模型在复杂水面环境下的潜力。**
    
- **超参数设置： 采用 SGD 优化器，初始学习率设为 0.01，动量为 0.937，权重衰减为 $5 \times 10^{-4}$。输入分辨率统一归一化为 $640 \times 640$。**
    
- **训练策略： 模型从头训练（Scratch）或加载 COCO 预训练权重（根据实际情况），共训练 200 Epochs。为了稳定 BatchNorm 统计量，我们在最后 10 个 Epoch 关闭 Mosaic 数据增强。**
    

#### **4.2 主实验结果对比 (Comparison with SOTA Methods)**

**为了证明 YOLO11-Mamba 的综合优势，我们将其与当前主流的实时目标检测器进行了全面对比，包括 CNN 架构的 YOLOv8, YOLOv9, YOLO10 以及 Transformer 架构的 RT-DETR。**

**如 Table 1 所示：**

1. **精度突破： 我们的方法在 mAP@50 指标上达到了 XX.X%，显著优于基准 YOLO11n (+X.X%) 和参数量更大的 RT-DETR-l (+X.X%)。这表明引入 Mamba 后，模型对水面小目标和透明目标的漏检率大幅降低。**
    
2. **复杂场景鲁棒性： 在更严格的 mAP@50-95 指标上，提升幅度更为显著。这得益于物理感知策略提供了额外的边缘信息，使得边界框回归更加精准。**
    
3. **速度与精度权衡： 尽管引入了 SSM 机制，但得益于 Mamba 的线性复杂度 $O(N)$，模型的推理速度（FPS）仍保持在 XX FPS。相比于计算密集的 Transformer 架构（如 RT-DETR），我们的方法在保持 SOTA 精度的同时，推理速度提升了约 X 倍，完美满足水面无人设备的实时性需求。**
    

#### **4.3 核心消融实验 (Ablation Studies)**

**这是验证本文“诊断-治疗”逻辑闭环的关键环节。我们从物理模态、FCE 引导的层级选择、以及网络结构有效性三个维度进行深入分析。**

**4.3.1 物理模态的有效性验证 (Impact of Physical Modalities)**

**为了验证“物理感知”并非多余，我们在固定网络结构（Baseline）的前提下，逐步引入不同模态策略（如 Table 2 所示）。**

******- **RGB Only:** 在强反光场景下表现较差，mAP 仅为 XX%。******
    
******- **RGB + Polarization (DoLP):** 精度提升显著 (**+X.X%**)。物理上的解释是：DoLP 图像中水面反光呈现高偏振值，而漂浮物为低偏振值，这种天然的物理对比度极大地降低了背景干扰。******
    
******- **Heterogeneous Training (Ours):** 采用全模态随机训练策略后，模型达到了最佳性能。这证明了通过学习跨模态的不变性特征，模型能够有效应对单一模态下的视觉伪装。******
    

********4.3.2 结构有效性分析：深度卷积 vs. 全局 SSM (Structural Effectiveness Analysis)********

******为了验证 FCE 诊断出的“语义塌陷”问题是源于网络**容量不足（Capacity）**还是**机制缺陷（Mechanism）**，我们设计了三组对比实验（如 **Table 3** 所示）。******

******- **Exp1 (Baseline):** 官方 YOLO11n，作为参照组。******
    
******- **Exp2 (Deep Backbone):** 将骨干网络 C3k2 深度翻倍 ($2 \times$)。******
    
    ******- _结果分析：_ 相比 Baseline，加深主干略微降低了类内距离 ($D_{intra}$)，说明增加非线性变换有助于提取更抽象的特征。然而，背景分离度 ($D_{inter}$) 提升有限，且 mAP 增益较小。******
        
******- **Exp3 (Deep Full):** 将骨干与颈部深度全部翻倍。******
    
    ******- _结果分析：_ 这种“暴力堆叠”策略虽然提升了 mAP，但代价巨大：参数量激增一倍，推理速度下降 **30%+**。更关键的是，其 $D_{inter}$ 改善依然不如预期，说明单纯增加卷积感受野仍难以捕捉全局水面的一致性。******
        
******- **Exp4 (Ours - Mamba):** 仅在 P4/P5 引入 Mamba。******
    
    ******- _结论：_ 我们的方法在仅增加少量参数的情况下，取得了最佳的 FCE 指标（低 $D_{intra}$，高 $D_{inter}$）和检测精度。这有力地证明了 Mamba 的 **SSM 机制** 能够利用全局上下文信息，比单纯堆叠深层卷积更有效地将前景从背景流形中“剥离”出来，且保持了极高的推理效率。******
        

********4.3.3 基于 FCE 诊断的层级选择验证 (Validation of FCE-Guided Layer Selection)********

******为了证明 FCE 诊断的准确性，我们进行了位置敏感性实验。******

******- 当我们将 Mamba 放置在 **P3 层（浅层）**时，性能提升微乎其微。这与 FCE 的分析一致——浅层特征主要依赖局部纹理，不需要长程依赖。******
    
******- 当我们根据 FCE 指引，精准地在 **P4 和 P5** 引入 Mamba 时，获得了最大幅度的性能增益。这证明了 FCE 框架作为“架构设计导航仪”的价值，避免了盲目的试错。******
    

******#### 4.4 可视化分析 (Qualitative Analysis)******

********4.4.1 FCE 再评估 (FCE Re-evaluation)********

******为了形成逻辑闭环，我们对训练好的 YOLO11-Mamba 模型再次进行了 FCE 分析。如图 **Fig. 1 (d)** 中的蓝色数据点所示，改进后的模型在 Layer 19 (P5) 的特征分离度显著提升，数据点从原本的“塌陷区（Collapsed Region）”回到了“理想区（Ideal Region）”。******

********4.4.2 Grad-CAM 热力图分析********

******如图 **Fig. 4** 所示，我们利用 Grad-CAM 技术可视化了模型的关注区域。******

******- **Baseline (RGB):** 热力图往往分散在周围发光的水波纹上，导致误检。******
    
******- **Ours (YOLO11-Mamba):** 热力图高度聚焦在漂浮物本体，且覆盖了整个物体轮廓。这证明了 Mamba 模块成功建立了全局上下文依赖，通过“抑制全局背景一致性”来凸显“局部异常目标”。******