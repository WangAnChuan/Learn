### **第三章 方法论 (Methodology)**

#### **3.1 整体框架 (Overall Framework)**

**针对水面漂浮物检测中存在的背景动态干扰（如光照反光、连续波纹）以及透明目标视觉特征模糊的问题，本文提出了一种物理感知与指标驱动的目标检测框架（Physically-Informed and Metric-Driven Framework）。如图 Fig. 3 所示，该框架以 YOLO11 为基准架构，但在两个关键维度上进行了创新性重构：**

1. **物理感知层面（Data-Centric）：我们摒弃了传统的单模态输入，转而采用异构多模态联合训练策略。除了传统的光强模态（RGB与Mono），我们进一步引入了包含线偏振度（DoLP）、偏振角（POL）、Pauli分解及差分（DIF）在内的全偏振物理特征。这种高维度的物理信息输入，不仅补充了物体表面的几何与材质纹理信息，更促使模型通过多流架构学习跨模态的光照不变性特征，从物理源头显著增强了模型在强反射或低对比度场景下的鲁棒性。**
    
2. **指标驱动层面（Model-Centric）：** 不同于盲目的网络堆叠，本研究提出了一种**指标驱动的架构优化策略。我们利用层级特征聚类评估（FCE）作为诊断探针，量化了特征空间的流形分布。揭示了特征融合阶段（特别是 Layer 19）存在显著的**类内方差漂移（High Intra-class Variance）**，表明模型在此处未能有效捕捉全局上下文以维持语义一致性。以此为依据，我们将**状态空间模型（Mamba）**嵌入该瓶颈层级，利用其线性复杂度的**全局感受野“压缩”同类特征分布，显著提升了特征的**语义紧致度（Semantic Compactness）**与判别力，实现了从“经验试错”向**“诊断-修复”**范式的跨越。
    

#### **3.2 物理感知的异构数据策略 (Physically-Informed Heterogeneous Data Strategy)**

**传统的水面目标检测算法往往仅依赖 RGB 图像，这使得模型极易受镜面反射（Specular Reflection）与视觉伪装（Visual Camouflage）的干扰。为了克服这一物理瓶颈，我们并未简单地增加网络输入的通道数，而是提出了一种“物理域随机化（Physical Domain Randomization）”的数据增强策略。****

**具体而言，我们将原始传感器数据解译为 $K=6$ 种异构的物理视图，并将其视为独立的训练样本：**
- **强度模态（Intensity Modalities）： 包括可见光（RGB）与近红外/单色（Mono）。这些模态提供了基础的纹理与几何轮廓信息。**
- 偏振模态（Polarization Modalities）： 包括线偏振度（DoLP）、偏振角（AoP）、以及 Pauli 分解分量。由于水面反射光通常具有高偏振特性，而漫反射的目标物体偏振度较低，这些模态能够为“前景-背景”分离提供正交的物理线索。
**形式化地，构建异构数据集 $\mathcal{D} = \{ (I_{RGB}, y), (I_{DoLP}, y), \dots \}$。通过在训练流中混合这些物理属性迥异的视图，我们迫使骨干网络忽略高频的模态特定噪声（如 RGB 中的反光伪影），转而聚焦于学习模态不变的几何特征。这一策略与后续引入的 Mamba 模块形成了完美的互补：异构数据提供了丰富的物理变化，而 Mamba 强大的全局上下文能力则能从中提取出稳健的结构化特征。
#### 3.3 指标驱动诊断：层级特征聚类评估 (Metric-Driven Diagnosis: FCE)**

**为了克服深度神经网络设计中的不可解释性，我们提出了 FCE 框架，旨在量化探测特征流形空间中前景（漂浮物）与背景（水面）的分布质量，从而为架构改良提供客观依据。**

### 3.3.1 FCE 评估机制 (FCE Evaluation Mechanism)

为了量化特征在深层网络中的演化行为，我们定义了层级特征聚类评估（Hierarchical Feature Clustering Evaluation, FCE）机制。令 $\mathcal{F}_l \in \mathbb{R}^{H \times W \times C}$ 表示主干网络第 $l$ 层输出的特征张量。

我们首先通过 RoIAlign操作，基于真值标注（Ground Truth, $B_{gt}$）与背景采样策略，分别提取前景特征集合 $\mathcal{V}_{fg}$ 与背景特征集合 $\mathcal{V}_{bg}$。为了缓解高维特征空间的稀疏性并提取主成分流形，我们采用主成分分析（PCA）将特征向量投影至低维子空间 $\mathbb{R}^d$。在此基础上，定义**Fisher 判别力分数（Fisher Discriminant Score, $S_{fce}$）**作为衡量特征可分性的核心指标：

$$S_{fce}^{(l)} = \frac{\|\boldsymbol{\mu}_{fg} - \boldsymbol{\mu}_{bg}\|_2^2}{\text{Tr}(\mathbf{\Sigma}_{fg}) + \text{Tr}(\mathbf{\Sigma}_{bg}) + \epsilon}$$

其中，$\boldsymbol{\mu}_{fg}, \boldsymbol{\mu}_{bg}$ 分别表示前景与背景特征簇在低维流形中的质心；$\mathbf{\Sigma}_{fg}, \mathbf{\Sigma}_{bg}$ 为对应的协方差矩阵，$\text{Tr}(\cdot)$ 表示矩阵的迹（即类内方差之和），用于度量特征分布的紧致度（Compactness）；$\epsilon$ 为数值稳定项。该指标在物理上等价于信噪比（SNR）：分子量化了“信号”（类间差异）的强度，分母量化了“噪声”（类内发散）的干扰。$S_{fce}$ 值越高，表明该层特征具备越强的语义判别力。

### 3.3.2 基于 FCE 的特征退化诊断 (FCE-guided Feature Degradation Diagnosis)

利用 FCE 探针，我们对基准模型（YOLO11）的关键层级（Indices: 13, 16, 19, 22）进行了逐层扫描，揭示了其在复杂水面环境下的特征表达瓶颈。

**1. 总体趋势分析（对应 Fig. 1a）：**

如图 Fig. 1(a) 所示，FCE 评分随网络深度呈现显著的非单调波动。尽管深层输出（Layer 22）的评分有所回升，但中间层级（特别是 Layer 13 与 Layer 19）出现了剧烈的**“语义塌陷（Semantic Collapse）”**。这表明，虽然检测头（Head）能够通过后处理恢复部分识别能力，但在 Backbone 的深层特征抽象阶段，模型已经丢失了大量关键的判别信息，形成了特征流形中的“断裂带”。

**2. 指标分解与病理分析（对应 Fig. 1b, 1c）：**

通过解耦 FCE 指标的分子与分母，我们定位了具体的病理特征：

- **类内发散（对应 Fig. 1b, Layer 19）：** Layer 19 表现出异常高的类内离散度（Intra-class Distance）。这意味着同一前景目标的特征在流形空间中极度发散。物理层面的解释是：深层卷积虽然感受野增大，但仍受限于局部窗口，对水面反光、倒影等局部形变过于敏感，导致模型未能将“破碎”的物体局部特征聚类为一个紧凑的语义整体。
    
- **背景混叠（对应 Fig. 1c, Layer 13）：** Layer 13 的类间分离度（Inter-class Separation）处于最低点。这揭示了模型在此层级无法有效抑制与前景纹理高度相似的水波纹噪声（Water ripples），导致前景与背景在特征空间中发生了严重的**语义纠缠（Semantic Entanglement）**，难以划定清晰的决策边界。
    

**3. 特征流形可视化（对应 Fig. 1d, 1e）：**

Fig. 1(d) 的二维散点图直观验证了上述诊断：基准模型的 Layer 19（红色数据点）明显偏离了理想的“左上角区域”（即高分离度、低类内方差），向着“高发散、低区分”的右下方漂移。此外，Fig. 1(e) 显示 PCA 的前 $d$ 个主成分累积解释方差均超过 90%，确证了上述流形投影能够真实反映原始高维特征的拓扑结构。

**诊断结论：**

FCE 诊断明确指出，Layer 13 至 Layer 19（对应 Backbone 的 P4/P5 融合阶段）是特征提取链路中的**“语义瓶颈”**。这种局部的特征退化本质上归因于**CNN 缺乏长距离依赖（Long-range Dependency）建模能力**——它无法利用水面的**全局上下文一致性**来校正局部的反光噪声或聚合发散的物体特征。这一量化结论为我们在该层级引入具有全局感受野的状态空间模型（Mamba）提供了坚实的理论与数据支撑。
#### **3.4 C3k2-Mamba：上下文感知的骨干重构 (C3k2-Mamba: Context-Aware Backbone Reconfiguration)**

**为了解决 FCE 诊断出的深层特征语义塌陷问题，我们需要一种能够突破卷积局部感受野限制的机制。虽然 Transformer 能够建立全局依赖，但其二次方计算复杂度（$O(N^2)$）难以满足水面无人设备的实时性要求。因此，我们引入了选择性状态空间模型（Selective State Space Models, Mamba）。**

**3.4.1 选择性状态空间模型原理**

**不同于卷积的滑动窗口机制，Mamba 将图像特征展平为一维序列，并利用线性时不变系统（LTI）进行长距离上下文扫描。其核心离散化状态方程定义如下：**

**\begin{align}**

**h_t &= \bar{\mathbf{A}} h_{t-1} + \bar{\mathbf{B}} x_t \****

**y_t &= \mathbf{C} h_t**

**\end{align}**

**其中，$x_t$ 为输入特征序列，$h_t$ 为隐状态，$y_t$ 为输出。通过这种递归形式，Mamba 能够在 $O(N)$ 的线性复杂度下，将整个水面的波浪纹理和光照分布编码进隐状态 $h_t$ 中。对于单类目标检测而言，这意味着模型在判断局部像素是否为“瓶子”时，不再仅仅依赖周围的几个像素，而是参考了全图的背景一致性信息，从而有效抑制与全局背景相似的局部反光噪声。**

**3.4.2 针对性的深层骨干重构**

基于 FCE 的诊断结论，我们实施了“**指标驱动的局部手术（Metric-Driven Local Surgery）**”策略。为了平衡计算效率与物理感知能力，我们保留了浅层（P1-P3）的卷积结构，以维持对高频物理特征（边缘、纹理）的提取优势。针对出现严重语义混叠的深层阶段（P4, P5），我们设计并植入了 **C3k2-Mamba** 模块，以替代原有的 Bottleneck 结构。

**C3k2-Mamba 模块设计：**

如图 Fig. 3 所示，该模块创新性地将状态空间模型（SSM）嵌入 CSP（Cross Stage Partial）流形架构中。不同于简单的残差堆叠，我们采用了一种**双流密集聚合（Dual-stream Dense Aggregation）**机制：

1. **特征分流（Feature Split）：** 输入张量 $X$ 首先经过 $1\times1$ 卷积降维，并在通道维度被分割为守恒流（Identity Stream, $X_{id}$）和计算流（Computational Stream, $X_{comp}$）。这确保了梯度的无损传播。
    
2. **级联状态空间建模（Cascaded SSM Modeling）：** 计算流进入堆叠的 Mamba Blocks 序列。为了最大化深层网络的**特征复用率（Feature Reuse）**，我们构建了密集连接链路。令 $M_i$ 表示第 $i$ 个 Mamba Block，输出序列 $Y_i$ 递归定义为：
    
    $$Y_0 = X_{comp}, \quad Y_i = M_i(Y_{i-1}), \quad \text{for } i=1 \dots N$$
    
3. **全维上下文重组（Full-Dimensional Context Reassembly）：** 最终的输出不仅仅是最后一个 Block 的结果，而是所有中间状态与初始分流的聚合。这种设计迫使模型在每一层都显式地将全局上下文（由 Mamba 提取）与局部特征进行对齐：
    
    $$Y_{out} = \text{Conv}_{1\times1}\left( \text{Concat}[X_{id}, Y_0, Y_1, \dots, Y_N] \right)$$
    

通过这种**密集拼接（Dense Concatenation）**策略，C3k2-Mamba 模块不仅利用 Mamba 的全局感受野修复了“语义断裂”，还通过保留 $X_{id}$ 和中间态 $Y_i$，在深层网络中建立了多尺度的语义索引。这使得模型能够利用全局上下文将孤立的前景目标从复杂的动态背景流形中精确剥离，直接响应了 FCE 诊断出的“类内发散”与“背景混叠”问题。
### **第四章 实验与结果分析 (Experiments and Analysis)**

#### **4.1 数据集与实验设置 (Datasets and Implementation Details)**

**4.1.1 以“瓶”为核心的异构感知基准 (Dataset Construction: Bottle-Centric Heterogeneous Benchmark)

针对水面漂浮物检测中最具挑战性的目标——**透明及半透明塑料瓶（Transparent/Semi-transparent Plastic Bottles）**，我们构建了一个专注于单一类别（Single-class）的多源异构感知基准。该基准通过整合物理光学属性与流体动力学特征，旨在攻克“透明瓶体难识别”与“动态水面难定位”的双重瓶颈。

我们对所有源数据进行了标签清洗与对齐（Label Alignment），将所有相关标注统一映射为**单一类别：“Bottle”**。基准由以下三个互补部分组成：

1. 光学物理锚点：PoTATO 数据集

- **核心作用：透明瓶体光学特征建模 (Optical Modeling of Transparent Bottles)**。
    
- **选择依据：** 塑料瓶通常呈现高透光率与弱纹理特征，是传统 RGB 检测器的盲区。我们精选了 **PoTATO** 数据集中包含“瓶（Bottle）”与“罐（Jar）”的子集。该数据集提供了高质量配准的**立体偏振（Stereo-polarimetric）**图像序列。
    
- **贡献：** 引入该数据源迫使模型学习透明瓶体特有的**偏振光学指纹（Polarimetric Optical Fingerprint）**——即利用偏振度（DoLP）揭示瓶体边缘的轮廓，利用偏振角（AoP）区分瓶身曲率与水面反光，从而在物理层面解决透明瓶体的“隐身”问题。
    

2. 动态环境上下文：FloW-Img 数据集

- **核心作用：漂浮姿态与遮挡适应 (Floating Pose and Occlusion Adaptation)**。
    
- **选择依据：** 真实水域中的瓶子往往处于半沉浮状态，且受水波扰动剧烈。我们引入 **FloW-Img** 数据集，重点筛选其中包含“塑料瓶（Plastic Bottle）”的样本。这些图像由无人船（USV）在不同流速下采集。
    
- **贡献：** 它弥补了实验室数据的静态性，提供了丰富的**半淹没（Semi-submerged）**、**倒影粘连（Reflection Adhesion）**及**密集堆积（Dense Clutter）**样本，使模型能够适应 USV 低机位视角下的复杂水面背景。
    

**3. 开放世界泛化：Wild-Bottle 2400+ (自建库)**

- **核心作用：长尾场景鲁棒性 (Long-tail Robustness)**。
    
- **组成：** 为了覆盖极端工况，我们从互联网收集并清洗了高难度图像，专注于**极端强反光（Specular Glare）**与**浑浊污水（Turbid Water）**下的瓶体检测，用于检验模型在非受控环境下的泛化边界。
    

#### 4.1.2 物理感知训练策略 (Physics-aware Training Strategy)

**标签统一与模态对齐 (Label Unification and Modality Alignment)：**

为了消除数据集间的语义偏差，我们将 PoTATO、FloW-Img 及其它水面图片中的所有目标标注统一映射为单类别索引 $C_{bottle}$。对于包含偏振信息的子集，我们将原始 RAW 数据解译为 $K=6$ 种异构物理视图（RGB, Mono, DoLP, AoP, $S_0$, Pauli-RGB）；对于仅含 RGB 的数据，则通过跨模态一致性约束进行标准化输入。

**异构模态联合训练 (Heterogeneous Modality Joint Training)：**

针对单一类别“Bottle”的训练，我们实施了**动态模态丢弃（Dynamic Modality Dropout）**策略。在训练迭代中，以 $p=0.5$ 的伯努利概率随机切换输入的物理模态组合。

- **对抗性学习目标：** 这种策略构建了一个对抗环境，迫使骨干网络解耦瓶子的“材质”与“环境”：
    
    1. 在有偏振数据时（源自 PoTATO），模型专注于学习透明材质的**物理几何边缘（Geometric Edges）**；
        
    2. 在仅有 RGB 数据时（源自 FloW-Img），模型专注于学习瓶身在水面的**漂浮形态（Floating Morphology）**。
        最终，通过这种交替优化，模型能够忽略反光伪影与水波噪声，提取出**模态不变的瓶体本征特征（Modality-Invariant Bottle Features）**。
    

**4.1.2 实施细节**

**所有实验均在 Ubuntu 22.04 系统下进行，硬件环境为单张 NVIDIA RTX 5090 GPU。**

- **基准模型： 选用 YOLO11n 作为 Baseline，以验证轻量化模型在复杂水面环境下的潜力。**
    
- **超参数设置： 采用 SGD 优化器，初始学习率设为 0.01，动量为 0.937，权重衰减为 $5 \times 10^{-4}$。输入分辨率统一归一化为 $640 \times 640$。**
    
- **训练策略： 模型从头训练（Scratch）或加载 COCO 预训练权重（根据实际情况），共训练 200 Epochs。为了稳定 BatchNorm 统计量，我们在最后 10 个 Epoch 关闭 Mosaic 数据增强。**
    

#### **4.2 主实验结果对比 (Comparison with SOTA Methods)**

**为了证明 YOLO11-Mamba 的综合优势，我们将其与当前主流的实时目标检测器进行了全面对比，包括 CNN 架构的 YOLOv8, YOLOv9, YOLO10 以及 Transformer 架构的 RT-DETR。**

**如 Table 1 所示：**

1. **精度突破： 我们的方法在 mAP@50 指标上达到了 XX.X%，显著优于基准 YOLO11n (+X.X%) 和参数量更大的 RT-DETR-l (+X.X%)。这表明引入 Mamba 后，模型对水面小目标和透明目标的漏检率大幅降低。**
    
2. **复杂场景鲁棒性： 在更严格的 mAP@50-95 指标上，提升幅度更为显著。这得益于物理感知策略提供了额外的边缘信息，使得边界框回归更加精准。**
    
3. **速度与精度权衡： 尽管引入了 SSM 机制，但得益于 Mamba 的线性复杂度 $O(N)$，模型的推理速度（FPS）仍保持在 XX FPS。相比于计算密集的 Transformer 架构（如 RT-DETR），我们的方法在保持 SOTA 精度的同时，推理速度提升了约 X 倍，完美满足水面无人设备的实时性需求。**
    

#### **4.3 核心消融实验 (Ablation Studies)**

**这是验证本文“诊断-治疗”逻辑闭环的关键环节。我们从物理模态、FCE 引导的层级选择、以及网络结构有效性三个维度进行深入分析。**

**4.3.1 物理模态的有效性验证 (Impact of Physical Modalities)**

**为了验证“物理感知”并非多余，我们在固定网络结构（Baseline）的前提下，逐步引入不同模态策略（如 Table 2 所示）。**

******- **RGB Only:** 在强反光场景下表现较差，mAP 仅为 XX%。******
    
******- **RGB + Polarization (DoLP):** 精度提升显著 (**+X.X%**)。物理上的解释是：DoLP 图像中水面反光呈现高偏振值，而漂浮物为低偏振值，这种天然的物理对比度极大地降低了背景干扰。******
    
******- **Heterogeneous Training (Ours):** 采用全模态随机训练策略后，模型达到了最佳性能。这证明了通过学习跨模态的不变性特征，模型能够有效应对单一模态下的视觉伪装。******
    

********4.3.2 结构有效性分析：深度卷积 vs. 全局 SSM (Structural Effectiveness Analysis)********

******为了验证 FCE 诊断出的“语义塌陷”问题是源于网络**容量不足（Capacity）**还是**机制缺陷（Mechanism）**，我们设计了三组对比实验（如 **Table 3** 所示）。******

******- **Exp1 (Baseline):** 官方 YOLO11n，作为参照组。******
    
******- **Exp2 (Deep Backbone):** 将骨干网络 C3k2 深度翻倍 ($2 \times$)。******
    
    ******- _结果分析：_ 相比 Baseline，加深主干略微降低了类内距离 ($D_{intra}$)，说明增加非线性变换有助于提取更抽象的特征。然而，背景分离度 ($D_{inter}$) 提升有限，且 mAP 增益较小。******
        
******- **Exp3 (Deep Full):** 将骨干与颈部深度全部翻倍。******
    
    ******- _结果分析：_ 这种“暴力堆叠”策略虽然提升了 mAP，但代价巨大：参数量激增一倍，推理速度下降 **30%+**。更关键的是，其 $D_{inter}$ 改善依然不如预期，说明单纯增加卷积感受野仍难以捕捉全局水面的一致性。******
        
******- **Exp4 (Ours - Mamba):** 仅在 P4/P5 引入 Mamba。******
    
    ******- _结论：_ 我们的方法在仅增加少量参数的情况下，取得了最佳的 FCE 指标（低 $D_{intra}$，高 $D_{inter}$）和检测精度。这有力地证明了 Mamba 的 **SSM 机制** 能够利用全局上下文信息，比单纯堆叠深层卷积更有效地将前景从背景流形中“剥离”出来，且保持了极高的推理效率。******
        

********4.3.3 基于 FCE 诊断的层级选择验证 (Validation of FCE-Guided Layer Selection)********

******为了证明 FCE 诊断的准确性，我们进行了位置敏感性实验。******

******- 当我们将 Mamba 放置在 **P3 层（浅层）**时，性能提升微乎其微。这与 FCE 的分析一致——浅层特征主要依赖局部纹理，不需要长程依赖。******
    
******- 当我们根据 FCE 指引，精准地在 **P4 和 P5** 引入 Mamba 时，获得了最大幅度的性能增益。这证明了 FCE 框架作为“架构设计导航仪”的价值，避免了盲目的试错。******
    

******#### 4.4 可视化分析 (Qualitative Analysis)******

********4.4.1 FCE 再评估 (FCE Re-evaluation)********

******为了形成逻辑闭环，我们对训练好的 YOLO11-Mamba 模型再次进行了 FCE 分析。如图 **Fig. 1 (d)** 中的蓝色数据点所示，改进后的模型在 Layer 19 (P5) 的特征分离度显著提升，数据点从原本的“塌陷区（Collapsed Region）”回到了“理想区（Ideal Region）”。******

********4.4.2 Grad-CAM 热力图分析********

******如图 **Fig. 4** 所示，我们利用 Grad-CAM 技术可视化了模型的关注区域。******

******- **Baseline (RGB):** 热力图往往分散在周围发光的水波纹上，导致误检。******
    
******- **Ours (YOLO11-Mamba):** 热力图高度聚焦在漂浮物本体，且覆盖了整个物体轮廓。这证明了 Mamba 模块成功建立了全局上下文依赖，通过“抑制全局背景一致性”来凸显“局部异常目标”。******