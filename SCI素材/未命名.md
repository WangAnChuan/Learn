### 第三章 方法论 (Methodology)

#### 3.1 整体框架 (Overall Framework)

针对水面漂浮物检测中存在的背景动态干扰（如光照反光、连续波纹）以及透明目标视觉特征模糊的问题，本文提出了一种**物理感知与指标驱动的目标检测框架（Physically-Informed and Metric-Driven Framework）**。如图 **Fig. 3** 所示，该框架以 YOLO11 为基准架构，但在两个关键维度上进行了创新性重构：

1. **物理感知层面（Data-Centric）**：我们摒弃了传统的单模态输入，转而采用**异构多模态联合训练**策略。通过引入偏振（DoLP/AoP）与单色（Mono）模态，迫使模型学习跨模态的不变性特征（Invariant Features），从物理源头增强对光照变化的鲁棒性。
    
2. **指标驱动层面（Model-Centric）**：不同于传统的“试错式”网络设计，我们引入了**层级特征聚类评估（FCE）**机制。该机制充当“诊断探针”，量化定位了特征提取网络中的薄弱环节，并指导我们在深层（P4, P5）集成**状态空间模型（Mamba）**，以恢复全局语义分离度。
    

#### 3.2 物理感知的异构数据策略 (Physically-Informed Heterogeneous Data Strategy)

传统的水面目标检测算法往往仅依赖 RGB 图像，这使得模型极易受镜面反射（Specular Reflection）与视觉伪装（Visual Camouflage）的干扰。为了克服这一物理瓶颈，我们并未简单地增加网络输入的通道数，而是提出了一种**“物理域随机化（Physical Domain Randomization）”**的数据增强策略。

具体而言，我们将原始传感器数据解译为 $K=6$ 种异构的物理视图，并将其视为独立的训练样本：

- **强度模态（Intensity Modalities）：** 包括可见光（RGB）与近红外/单色（Mono）。这些模态提供了基础的纹理与几何轮廓信息。
    
- **偏振模态（Polarization Modalities）：** 包括线偏振度（DoLP）、偏振角（AoP）、以及 Pauli 分解分量。由于水面反射光通常具有高偏振特性，而漫反射的目标物体偏振度较低，这些模态能够为“前景-背景”分离提供正交的物理线索。
    

形式化地，构建异构数据集 $\mathcal{D} = \{ (I_{RGB}, y), (I_{DoLP}, y), \dots \}$。通过在训练流中混合这些物理属性迥异的视图，我们迫使骨干网络忽略高频的模态特定噪声（如 RGB 中的反光伪影），转而聚焦于学习**模态不变的几何特征（Modality-Invariant Geometric Features）**。这一策略与后续引入的 Mamba 模块形成了完美的互补：异构数据提供了丰富的物理变化，而 Mamba 强大的全局上下文能力则能从中提取出稳健的结构化特征。

#### 3.3 指标驱动诊断：层级特征聚类评估 (Metric-Driven Diagnosis: FCE)

为了克服深度神经网络设计中的不可解释性，我们提出了 FCE 框架，旨在量化探测特征流形空间中前景（漂浮物）与背景（水面）的分布质量，从而为架构改良提供客观依据。

**3.3.1 评估机制**

令 $\mathcal{F}_l \in \mathbb{R}^{H \times W \times C}$ 表示第 $l$ 层输出的特征图。基于真实标签（Ground Truth），我们分别采样前景特征向量集合 $V_{fg}$ 与背景特征向量集合 $V_{bg}$。为了消除高维空间的稀疏性并直观可视化，我们采用主成分分析（PCA）将特征向量投影至低维流形空间，并定义**类间分离度分数（Separation Score, $S_{sep}$）**：

$$S_{sep}^{(l)} = \frac{\|\mu_{fg} - \mu_{bg}\|_2}{\sqrt{\sigma_{fg}^2 + \sigma_{bg}^2} + \epsilon}$$

其中，$\mu$ 和 $\sigma^2$ 分别代表特征簇的质心与方差，$\epsilon$ 为防止分母为零的平滑项。$S_{sep}$ 值越高，意味着特征空间中的“前景-背景”边界越清晰。

**3.3.2 基于 FCE 的特征退化量化诊断**

为了探究基准模型（YOLO11）在水面复杂环境下的特征表达瓶颈，我们利用 FCE 框架对网络关键层级（索引为 13, 16, 19, 22）的特征空间进行了逐层扫描。

- **总体趋势分析（对应图 Fig. 1a）：** 如图 **Fig. 1(a)** 所示，FCE 综合评分在不同网络深度呈现出显著波动。相比于深层输出（Layer 22），中间层级（Layer 13 和 19）的评分出现了剧烈的**“塌陷（Collapse）”**。这表明，虽然网络最终能够通过 Head 部分恢复一定的识别能力，但在 Backbone 的深层特征提取阶段，模型已经丢失了大量关键的判别信息。
    
- **指标分解与病理分析（对应图 Fig. 1b, 1c）：**
    
    - **类内紧凑度（图 b）：** Layer 19 表现出了异常高的类内距离，意味着前景目标的特征分布极度发散，模型未能将其聚类为一个紧凑的语义整体，这通常归因于深层卷积对目标局部形变的不敏感。
        
    - **前景-背景分离度（图 c）：** Layer 13 和 Layer 19 的背景分离度显著偏低。这揭示了一个关键问题：在这些层级，模型无法有效抑制与前景纹理相似的水波纹噪声，导致前景与背景在特征空间中发生了严重的**“语义混叠（Semantic Entanglement）”**。
        
- **特征空间可视化（对应图 Fig. 1d, 1e）：** **Fig. 1(d)** 的二维散点图直观展示了这种退化：基准模型的 Layer 13 和 19（红色圆点）明显向右下方漂移，远离了理想的高分离度区域。此外，**Fig. 1(e)** 显示所有层级的 PCA 累积解释方差均超过 0.90，证明了上述流形投影的有效性。
    

**诊断结论：** FCE 诊断明确指出 Layer 13 和 Layer 19（对应 Backbone 的 P4/P5 阶段）是特征提取链路中的“薄弱环节”。这种局部的特征混叠现象，本质上是由于卷积核缺乏长距离依赖建模能力，无法利用水面的全局一致性来剔除局部反光噪声。这为后续引入全局感受野模块提供了直接的指标依据。

#### 3.4 C3k2-Mamba：上下文感知的骨干重构 (C3k2-Mamba: Context-Aware Backbone Reconfiguration)

为了解决 FCE 诊断出的深层特征语义塌陷问题，我们需要一种能够突破卷积局部感受野限制的机制。虽然 Transformer 能够建立全局依赖，但其二次方计算复杂度（$O(N^2)$）难以满足水面无人设备的实时性要求。因此，我们引入了**选择性状态空间模型（Selective State Space Models, Mamba）**。

**3.4.1 选择性状态空间模型原理**

不同于卷积的滑动窗口机制，Mamba 将图像特征展平为一维序列，并利用线性时不变系统（LTI）进行长距离上下文扫描。其核心离散化状态方程定义如下：

\begin{align}

h_t &= \bar{\mathbf{A}} h_{t-1} + \bar{\mathbf{B}} x_t \

y_t &= \mathbf{C} h_t

\end{align}

其中，$x_t$ 为输入特征序列，$h_t$ 为隐状态，$y_t$ 为输出。通过这种递归形式，Mamba 能够在 $O(N)$ 的线性复杂度下，将整个水面的波浪纹理和光照分布编码进隐状态 $h_t$ 中。对于单类目标检测而言，这意味着模型在判断局部像素是否为“瓶子”时，不再仅仅依赖周围的几个像素，而是参考了全图的背景一致性信息，从而有效抑制与全局背景相似的局部反光噪声。

**3.4.2 针对性的深层骨干重构**

基于第 3.3 节的 FCE 诊断结论，我们采取了**“指标驱动的局部手术（Metric-Driven Local Surgery）”**策略。具体而言，我们保持了 YOLO11 骨干网络中浅层（P1-P3）的 C3k2 卷积模块不变，以保留其对边缘、角点等高频物理特征的高效提取能力。而在出现特征混叠的深层阶段（P4 和 P5），我们将原有的 Bottleneck 替换为 **C3k2-Mamba** 模块。

如图 **Fig. 3 (Micro View)** 所示，在该模块中，输入的深层语义特征首先经过 $1\times1$ 卷积降维，随后被分割为两条路径。主路径进入堆叠的 Mamba Block 进行全局上下文聚合。为了最大化特征复用，我们采用了**密集拼接（Dense Concatenation）**策略：

$$Y_{out} = \text{Conv}_{1\times1}\left( \text{Concat}[Y_{shortcut}, Y_{main}, Y_{mamba}^{(1)}, \dots, Y_{mamba}^{(N)}] \right)$$

这种设计确保了深层网络能够“看清”水面全貌，利用全局上下文将孤立的前景目标从复杂的动态背景流形中剥离出来，直接修复了 FCE 揭示的语义混叠缺陷。